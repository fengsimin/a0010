<?php
//Copyright (c) 2016 iFeiwu.com
 class Item extends Ifeiwu { public function __construct() { goto YLsmx; BvkmK: jiQyh: goto f2lnP; YLsmx: if ($this->table) { goto jiQyh; } goto PhdpY; PhdpY: $this->table = "\x69\164\x65\155"; goto BvkmK; f2lnP: parent::__construct(); goto RJQS2; RJQS2: } protected function postPage($request_data) { goto WiCdI; DL6oQ: $data = $this->db->select($this->table, $column)->where($where)->order($order)->all(); goto wOcDe; wOcDe: goto m4Ujg; goto qh9vQ; kLc2x: $column = $request_data["\x63\157\154\165\155\x6e"] ?: "\52"; goto W5iJL; gZM6z: if ($perpage > 0) { goto rsq6g; } goto DL6oQ; DHEGo: $this->_callback("\x63\141\154\154\x62\x61\143\x6b\120\141\x67\145\101\146\x74\x65\162", array(&$data)); goto r8UJ0; WzG4Q: $data = array("\154\151\x73\164" => $list, "\164\x6f\x74\141\154" => $total, "\x70\x65\162\160\x61\x67\145" => $perpage, "\160\x61\x67\x65" => $page); goto AC6c1; ZGwUj: $perpage = $request_data["\x70\145\162\160\x61\147\x65"] ?: 0; goto gZM6z; yL9fV: $list = $this->db->select($this->table, $column)->where($where)->order($order)->limit(array($page * $perpage, $perpage))->all(); goto WzG4Q; r8UJ0: return $this->success($data); goto IKnRp; AC6c1: m4Ujg: goto DHEGo; FIgfO: $total = $this->db->select($this->table)->where($where)->count(); goto yL9fV; W5iJL: $where = $request_data["\x77\150\145\x72\x65"] ?: "\x31\x20\75\x20\61"; goto z8yQE; qh9vQ: rsq6g: goto YoxOg; VIBn2: $page = $page ? $page - 1 : 0; goto FIgfO; z8yQE: $order = $request_data["\x6f\162\x64\145\162"] ?: $this->order; goto ZGwUj; YoxOg: $page = $request_data["\x70\x61\x67\145"] ?: 1; goto VIBn2; WiCdI: $this->_callback("\x63\x61\x6c\x6c\x62\x61\143\x6b\x50\141\x67\x65\102\145\x66\157\162\x65", array(&$request_data)); goto kLc2x; IKnRp: } protected function postQuery($request_data) { goto ktBXV; I06Qo: wftSP: goto R2bVq; ktBXV: $sql = $request_data["\163\x71\x6c"]; goto vxiKP; vxiKP: if (!(stripos($sql, "\44\164\x61\142\154\x65") !== false)) { goto wftSP; } goto V5KHy; R2bVq: return $this->db->query($sql, $request_data["\x76\x61\x6c\165\x65\x73"])->all(); goto dKI25; V5KHy: $sql = str_replace("\x24\164\141\142\x6c\x65", $this->prefix . $this->table, $sql); goto I06Qo; dKI25: } protected function getOne($id, $column = null) { goto JxQJM; ONBoL: return $this->success($data); goto vxSo7; dPvTV: $data = $this->db->select($this->table, $column)->where(array("\x69\144", "\75", $id))->get(); goto ONBoL; JxQJM: $column = $column ?: "\x2a"; goto dPvTV; vxSo7: } protected function postAdd($request_data) { goto ieMNX; QV2eu: $upload_path = $request_data["\x24\165\x70\154\157\x61\x64\x5f\x70\x61\x74\x68"]; goto oQhvY; PNs9_: $id = $this->db->insert($this->table, $data)->id(); goto o1dNY; fmIvS: if (!($pid > 0 && in_array("\x6c\145\166\145\154", $this->fields))) { goto vy7lX; } goto cdDap; MONsY: $udata[$upload_name] = $upload_path; goto hrazL; poeRO: RTah_: goto bcRhr; bcRhr: $udata = array("\x69\144" => $id); goto fiMui; aoRqZ: if ($this->db->update($this->table, $udata, array("\151\x64", "\75", $id))->is()) { goto drklZ; } goto HCCXf; cdDap: $udata["\154\145\166\145\154"] = $this->_getLevel($pid, $id); goto pxRf7; oQhvY: if (!($upload_name && $upload_path)) { goto K2U21; } goto riBiB; ieMNX: $this->_callback("\x63\141\154\154\142\x61\x63\153\101\144\144\x42\x65\146\x6f\162\145", array(&$request_data)); goto mPLNN; b2aaq: $this->_log("\x61\x64\144", array("\164\x69\x74\x6c\145" => $data["\164\151\164\x6c\x65"], "\164\x61\142\154\x65\137\151\x64" => $id)); goto abNx2; HCCXf: $this->db->rollBack(); goto bvFR2; dBT9x: drklZ: goto QOq95; NCIJe: $upload_name = $request_data["\x24\165\x70\154\157\141\144\137\x6e\x61\x6d\x65"]; goto QV2eu; AIsxx: $this->db->beginTransaction(); goto PNs9_; QOq95: $this->_callback("\143\x61\x6c\x6c\x62\x61\x63\153\101\144\x64\101\x66\164\x65\x72", array($id, &$request_data)); goto b2aaq; abNx2: $this->db->commit(); goto F0b2p; Hq573: return $this->error("\346\xb7\xbb\xe5\x8a\xa0\xe6\225\xb0\xe6\x8d\xae\345\xa4\xb1\xe8\264\245\xef\274\x81"); goto poeRO; F0b2p: return $this->success("\xe6\xb7\273\xe5\212\240\346\x95\xb0\346\x8d\256\xe6\210\x90\345\212\x9f\xef\xbc\201", array("\x69\144" => $id, "\151\x6d\141\147\145\x5f\x70\141\x74\150" => $upload_path)); goto C9wjS; loGIS: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto MONsY; EJIKk: $data["\143\x74\151\x6d\x65"] = time(); goto AIsxx; o1dNY: if ($id) { goto RTah_; } goto Hq573; hrazL: K2U21: goto aoRqZ; pxRf7: vy7lX: goto NCIJe; mPLNN: $this->_removeFiles2($request_data["\x5f\162\x65\x6d\157\166\x65\x66\x69\154\145\163"]); goto rF6Mr; C9wjS: NZ24e: goto NqmOi; bvFR2: return $this->error("\346\267\273\xe5\x8a\240\xe6\225\xb0\xe6\215\xae\xe5\244\261\350\xb4\245\xef\274\201"); goto REIbU; REIbU: goto NZ24e; goto dBT9x; fiMui: $pid = $data["\160\x69\x64"]; goto fmIvS; rF6Mr: $data = $this->_bulidData($request_data); goto EJIKk; riBiB: $data["\151\144"] = $id; goto loGIS; NqmOi: } protected function postUpdate($id, $request_data) { goto iNb_k; nGISd: if ($this->db->update($this->table, $data, array("\x69\144", "\75", $id))->is()) { goto lycz0; } goto o8Vwq; P6BVd: $data["\x75\164\151\x6d\x65"] = time(); goto pTb9N; o8Vwq: return $this->error("\344\277\235\xe5\255\x98\345\244\xb1\xe8\xb4\xa5\357\xbc\x81"); goto chaG6; ETMVO: return $this->success("\xe5\267\xb2\xe4\277\235\345\xad\230\xe6\233\264\xe6\224\271\xef\xbc\x81"); goto bMhnS; chaG6: goto CNasL; goto RSWvf; tnG4D: $data["\154\145\x76\145\x6c"] = $this->_getLevel($pid, $id); goto txSrV; XVrqe: $data[$upload_name] = $upload_path; goto STO58; RSWvf: lycz0: goto kMbOo; nibB1: $upload_name = $request_data["\44\x75\x70\154\157\x61\x64\x5f\x6e\x61\x6d\145"]; goto sz7D3; nrQLU: if (!($upload_name && $upload_path)) { goto YX5Sx; } goto ZLX7o; kMbOo: $this->_callback("\x63\141\154\154\142\141\x63\x6b\125\x70\144\141\164\145\101\146\x74\145\162", array($id, &$request_data)); goto iHxa9; YHrMc: YX5Sx: goto nGISd; HpN_v: $data = $this->_bulidData($request_data); goto P6BVd; sz7D3: $upload_path = $request_data["\x24\x75\x70\154\x6f\141\x64\137\x70\x61\x74\150"]; goto nrQLU; ZLX7o: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto UZ4QM; iNb_k: $this->_callback("\x63\x61\154\154\142\x61\x63\153\125\x70\144\141\x74\145\x42\x65\x66\157\162\145", array(&$request_data)); goto kKTqu; UZ4QM: if (!in_array($upload_name, $this->fields)) { goto EZldf; } goto XVrqe; pTb9N: $pid = $data["\160\151\144"]; goto K4aEp; txSrV: b7ETj: goto nibB1; kKTqu: $this->_removeFiles2($request_data["\137\162\145\155\157\x76\145\x66\151\154\x65\x73"]); goto HpN_v; bMhnS: CNasL: goto dCGdy; STO58: EZldf: goto YHrMc; iHxa9: $this->_log("\x75\x70\x64\x61\x74\x65", array("\164\x69\x74\154\145" => $data["\164\x69\x74\154\145"])); goto ETMVO; K4aEp: if (!($pid > 0 && in_array("\x6c\145\166\x65\x6c", $this->fields))) { goto b7ETj; } goto tnG4D; dCGdy: } protected function postField($request_data) { goto WQBSz; GlepL: return $this->error(); goto gtEvo; WQBSz: $ids = $request_data["\x69\144"]; goto nb705; fsvqf: xQxKm: goto rFHDs; fEF3a: $value = $request_data["\166\x61\154\x75\x65"]; goto cy1Ab; cy1Ab: if ($this->db->update($this->table, array($name => $value), array("\151\x64", "\x49\116", $ids))->is()) { goto xQxKm; } goto GlepL; rFHDs: return $this->success(); goto n7SJ1; nb705: $name = $request_data["\x6e\x61\155\x65"]; goto fEF3a; n7SJ1: Q_wB0: goto XB1qQ; gtEvo: goto Q_wB0; goto fsvqf; XB1qQ: } protected function postCount($request_data) { goto wn4d0; wn4d0: $table = $request_data["\x74\141\142\x6c\x65"] ?: $this->table; goto vIse8; vIse8: $where = $request_data["\x77\150\145\162\x65"] ?: "\61\x20\75\40\x31"; goto h7WRt; h7WRt: return $this->db->select($table)->where($where)->count(); goto qc7A0; qc7A0: } protected function postDelete($request_data) { goto D6dmF; Euae3: foreach ($ids as $id) { goto J4IAJ; bzXLY: goto BX2dX; goto UclT6; XGnRe: goto CAsI2; goto bzXLY; Vr2Et: BX2dX: goto oGjrA; f3fsi: $error[] = $id; goto XGnRe; oGjrA: CAsI2: goto zynXs; UclT6: albn0: goto wIalF; wIalF: $this->_trash($item, $request_data); goto Vr2Et; ldjRs: if ($this->db->delete($this->table, array("\151\x64", "\x3d", $id))->is()) { goto albn0; } goto f3fsi; J4IAJ: $item = $this->db->select($this->table)->where(array("\x69\x64", "\75", $id))->get(); goto ldjRs; zynXs: } goto V_9ox; yrYrT: $ids = $request_data["\x69\x64"]; goto vell0; D6dmF: $this->_callback("\143\141\x6c\x6c\142\141\x63\153\104\x65\154\x65\164\x65\102\x65\x66\157\162\x65", array(&$request_data)); goto zfAMG; jKmHs: return $this->error("\346\x9c\x89\40" . count($error) . "\xe6\235\xa1\xe6\225\260\xe6\x8d\xae\345\x88\240\351\231\244\345\xa4\xb1\350\xb4\245\xef\xbc\201"); goto OpWdI; rR6ig: NL0Sd: goto GCeyo; SbNwE: $this->db->commit(); goto AL99_; zfAMG: $error = array(); goto yrYrT; OpWdI: goto NL0Sd; goto EJHSm; AL99_: $this->_log("\x72\145\x6d\x6f\166\145", array("\164\151\x74\x6c\145" => count($ids))); goto aIN_Z; iqenh: $this->db->rollBack(); goto jKmHs; aIN_Z: return $this->success(); goto rR6ig; vell0: $this->db->beginTransaction(); goto Euae3; yvwnO: if (count($error) === 0) { goto xYzn9; } goto iqenh; E8bHn: $this->_callback("\143\x61\154\154\x62\x61\x63\x6b\104\145\154\145\164\145\101\x66\164\x65\162", array(&$request_data)); goto SbNwE; V_9ox: JMMhl: goto yvwnO; EJHSm: xYzn9: goto E8bHn; GCeyo: } }
