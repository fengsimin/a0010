<?php
//Copyright (c) 2016 iFeiwu.com
 class Site extends Item { function __construct() { $this->table = "\163\151\x74\145"; parent::__construct(); } protected function getData() { goto CbcUI; wPx0J: foreach ($data as $d) { goto w1Z3v; pq0np: $site[$d["\x6e\x61\155\x65"]] = $value; goto UXTFz; w1Z3v: $value = $d["\166\141\x6c\165\145"]; goto Dq6DK; Dq6DK: if (!($value != '')) { goto Zr40i; } goto pq0np; krcAJ: Zezut: goto kyGBt; UXTFz: Zr40i: goto krcAJ; kyGBt: } goto O2elA; O2elA: piTvj: goto PmkU2; PmkU2: return $this->success($site); goto hIUhn; CbcUI: $data = $this->db->select($this->table)->all(); goto UFc9X; UFc9X: $site = array(); goto wPx0J; hIUhn: } protected function postSave($request_data) { goto mQpKm; bJZOP: PRVzq: goto laAMq; mQpKm: $this->_removeFiles2($request_data["\x5f\162\x65\x6d\157\166\x65\x66\151\154\x65\163"]); goto byAMJ; sfxGN: v_4S0: goto R3EFC; TUIk6: return $this->error("\345\xb7\262\344\xbf\x9d\xe5\xad\x98\345\xa4\xb1\350\xb4\245\xef\274\201"); goto YnN8s; VTz66: $this->_log("\x75\160\x64\x61\x74\145", array("\x74\x69\x74\x6c\x65" => "\xe7\275\221\xe7\253\x99\350\xae\xbe\xe7\xbd\xae")); goto P1sI7; V4qvT: $error = array(); goto lIbzK; lIbzK: $this->db->beginTransaction(); goto hcrnV; laAMq: if (count($error) === 0) { goto v2UKl; } goto ntziB; YnN8s: goto v_4S0; goto o0mB7; hcrnV: foreach ($request_data as $name => $value) { goto xstLo; xstLo: $count = $this->db->select($this->table)->where(array("\156\141\155\x65", "\x3d", $name))->count(); goto tlGQu; nyicI: II_VB: goto c5O8b; BewM0: if (!($this->db->update($this->table, array("\x76\141\154\x75\145" => $value), array("\156\141\155\145", "\75", $name))->is() === false)) { goto c1ncb; } goto lGClm; lGClm: $error[] = $name; goto HOmZ4; ng6o0: XyDVt: goto nyicI; PnccJ: $error[] = $name; goto Fch0B; bHEES: goto XyDVt; goto MGjyL; NXRhS: if ($count <= 0) { goto XViQe; } goto BewM0; HOmZ4: c1ncb: goto bHEES; BAgxW: if (!($this->db->insert($this->table, array("\x6e\x61\x6d\145" => $name, "\x76\141\x6c\165\x65" => $value))->is() === false)) { goto INlVD; } goto PnccJ; Fch0B: INlVD: goto ng6o0; tlGQu: $value = $this->_encode($value); goto NXRhS; MGjyL: XViQe: goto BAgxW; c5O8b: } goto bJZOP; o0mB7: v2UKl: goto XSlrj; ntziB: $this->db->rollBack(); goto TUIk6; XSlrj: $this->db->commit(); goto VTz66; P1sI7: return $this->success("\345\xb7\262\xe4\277\x9d\xe5\xad\x98\xe6\233\264\346\x94\271\357\xbc\201"); goto sfxGN; byAMJ: unset($request_data["\164\157\x6b\145\x6e"], $request_data["\x61\144\x6d\151\x6e"], $request_data["\137\162\x65\155\157\x76\x65\x66\x69\x6c\x65\x73"]); goto V4qvT; R3EFC: } protected function postSkin($request_data) { goto Nod2X; lXE3t: file_put_contents($filename, $request_data["\x73\164\x79\154\x65\x2d\143\x6f\144\145"]); goto DdyWe; m1NE5: return $this->success("\xe5\xb7\262\344\277\x9d\xe5\xad\x98\346\x9b\264\346\224\271\357\xbc\201"); goto L0FS1; Nod2X: if (!isset($request_data["\x73\x74\x79\x6c\145\55\x63\157\144\145"])) { goto Nptth; } goto T0tz1; wOn2d: RnYys: goto STR9F; T0tz1: $filename = "\x2e\x2e\57\x61\x73\x73\145\164\x2f\143\163\163\x2f\x73\164\x79\154\145\56\143\x73\163"; goto lXE3t; STR9F: foreach ($request_data as $name => $value) { $this->_saveData($this->table, array("\156\141\155\x65" => $name, "\166\x61\x6c\x75\145" => $value), array("\156\141\x6d\x65", "\75", $name)); Yk4P3: } goto YK5DI; I8EZN: $request_data["\x73\x6b\151\156"] = $skins[1]; goto wOn2d; YK5DI: LB5VM: goto m1NE5; MhHN0: Nptth: goto bVdgX; pUinw: $skins = explode("\55", $request_data["\x74\150\145\155\145\55\163\x6b\x69\156"]); goto hZYeh; DdyWe: chmod($filename, 420); goto MhHN0; bVdgX: unset($request_data["\164\157\x6b\145\x6e"], $request_data["\141\x64\x6d\151\156"], $request_data["\163\164\171\154\x65\55\x63\157\x64\145"]); goto HVt7T; HVt7T: if (!isset($request_data["\164\150\x65\x6d\145\x2d\x73\153\151\x6e"])) { goto RnYys; } goto pUinw; hZYeh: $request_data["\x74\150\x65\x6d\x65"] = $skins[0]; goto I8EZN; L0FS1: } protected function getStyleCode() { $code = file_get_contents("\56\x2e\57\141\163\163\x65\x74\57\143\x73\x73\57\163\164\x79\154\145\56\x63\x73\x73"); return $this->success(array($code)); } }
